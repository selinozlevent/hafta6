<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>To‑Do List</title>
    <style>
      :root {
        --bg: #f7f7f9;
        --card: #ffffff;
        --text: #222;
        --muted: #666;
        --primary: #2f6fed;
        --primary-ghost: rgba(47, 111, 237, 0.12);
        --success: #2ecc71;
        --danger: #e74c3c;
        --border: #e5e7eb;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        background: linear-gradient(180deg, #f0f3ff 0%, var(--bg) 100%);
        color: var(--text);
      }
      .container {
        max-width: 720px;
        margin: 48px auto;
        padding: 0 20px;
      }
      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
        overflow: hidden;
      }
      .header {
        padding: 24px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .header h1 {
        font-size: 20px;
        margin: 0;
        letter-spacing: 0.2px;
      }
      .header .count {
        margin-left: auto;
        font-size: 14px;
        color: var(--muted);
      }
      .input-row {
        padding: 16px 24px 24px;
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 12px;
      }
      input[type="text"] {
        width: 100%;
        padding: 12px 14px;
        border: 1px solid var(--border);
        border-radius: 10px;
        font-size: 15px;
        outline: none;
        background: #fbfbfd;
      }
      input[type="text"]:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 4px var(--primary-ghost);
      }
      button {
        padding: 12px 16px;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
      }
      .btn-primary {
        background: var(--primary);
        color: #fff;
      }
      .btn-primary:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .list {
        padding: 8px 8px 16px;
      }
      .item {
        display: grid;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        margin: 8px 16px;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: #fff;
      }
      .item.completed {
        opacity: 0.75;
      }
      .item.completed .title {
        text-decoration: line-through;
        color: var(--muted);
      }
      .title {
        font-size: 15px;
        line-height: 1.4;
      }
      .actions {
        display: flex;
        gap: 8px;
      }
      .chip {
        font-size: 12px;
        padding: 6px 8px;
        border-radius: 8px;
        border: 1px solid var(--border);
        color: var(--muted);
        background: #fafafa;
      }
      .btn-icon {
        background: transparent;
        color: var(--text);
        border: 1px solid var(--border);
      }
      .btn-icon:hover {
        background: #f6f7fb;
      }
      .btn-success {
        color: #fff;
        background: var(--success);
        border: none;
      }
      .btn-danger {
        color: #fff;
        background: var(--danger);
        border: none;
      }
      .footer {
        padding: 16px 24px 24px;
        display: flex;
        gap: 8px;
        border-top: 1px solid var(--border);
      }
      .filter {
        padding: 8px 12px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: #fff;
        cursor: pointer;
        font-size: 14px;
      }
      .filter.active {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px var(--primary-ghost);
      }
      @media (max-width: 520px) {
        .item {
          grid-template-columns: auto 1fr;
        }
        .actions {
          grid-column: 1 / -1;
          justify-content: flex-end;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card" id="app">
        <div class="header">
          <h1>Görevlerim</h1>
          <span class="count" id="count">0 tamamlanmamış</span>
        </div>

        <div class="input-row">
          <input
            id="input"
            type="text"
            placeholder="Örn: Kapusuzlar Emaye ürün sayfası taslağını bitir"
          />
          <button id="addBtn" class="btn-primary">Ekle</button>
        </div>

        <div class="list" id="list"></div>

        <div class="footer">
          <button class="filter active" data-filter="all">Tümü</button>
          <button class="filter" data-filter="active">Aktif</button>
          <button class="filter" data-filter="completed">Tamamlanan</button>
          <button class="filter" id="clearCompleted">
            Tamamlananları temizle
          </button>
        </div>
      </div>
    </div>

    <script>
      // ——— Basit state ve localStorage ———
      const STORAGE_KEY = "todo-items-v1";
      let items = load();
      let currentFilter = "all";

      const input = document.getElementById("input");
      const addBtn = document.getElementById("addBtn");
      const listEl = document.getElementById("list");
      const countEl = document.getElementById("count");
      const filterBtns = document.querySelectorAll(".filter");
      const clearCompletedBtn = document.getElementById("clearCompleted");

      render();

      addBtn.addEventListener("click", addItem);
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") addItem();
      });

      filterBtns.forEach((btn) => {
        btn.addEventListener("click", () => {
          filterBtns.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          currentFilter = btn.dataset.filter;
          render();
        });
      });

      clearCompletedBtn.addEventListener("click", () => {
        items = items.filter((i) => !i.completed);
        save();
        render();
      });

      // ——— Fonksiyonlar ———
      function addItem() {
        const title = input.value.trim();
        if (!title) return;
        items.push({
          id: crypto.randomUUID(),
          title,
          completed: false,
          createdAt: Date.now(),
        });
        input.value = "";
        save();
        render();
      }

      function toggleItem(id) {
        items = items.map((i) =>
          i.id === id ? { ...i, completed: !i.completed } : i
        );
        save();
        render();
      }

      function deleteItem(id) {
        items = items.filter((i) => i.id !== id);
        save();
        render();
      }

      function editItem(id) {
        const item = items.find((i) => i.id === id);
        if (!item) return;
        const next = prompt("Görevi düzenle:", item.title);
        if (next === null) return;
        const title = next.trim();
        if (!title) return;
        items = items.map((i) => (i.id === id ? { ...i, title } : i));
        save();
        render();
      }

      function render() {
        // Filtre uygula
        const visible = items.filter((i) => {
          if (currentFilter === "active") return !i.completed;
          if (currentFilter === "completed") return i.completed;
          return true;
        });

        // Listeyi temizle
        listEl.innerHTML = "";

        // Öğeleri ekle
        visible.forEach((i) => {
          const row = document.createElement("div");
          row.className = "item" + (i.completed ? " completed" : "");
          row.innerHTML = `
          <button class="btn-icon" aria-label="Tamamla">
            ${i.completed ? "✓" : "○"}
          </button>
          <div class="title">${escapeHtml(i.title)}</div>
          <div class="actions">
            <span class="chip">${formatDate(i.createdAt)}</span>
            <button class="btn-icon" aria-label="Düzenle">Düzenle</button>
            <button class="btn-danger" aria-label="Sil">Sil</button>
          </div>
        `;

          // Tamamlama
          row.children[0].addEventListener("click", () => toggleItem(i.id));
          // Düzenleme
          row
            .querySelector(".actions .btn-icon")
            .addEventListener("click", () => editItem(i.id));
          // Silme
          row
            .querySelector(".actions .btn-danger")
            .addEventListener("click", () => deleteItem(i.id));

          listEl.appendChild(row);
        });

        // Sayaç
        const remaining = items.filter((i) => !i.completed).length;
        countEl.textContent = `${remaining} tamamlanmamış`;

        // Ekle butonu
        addBtn.disabled = !input.value.trim();
        input.addEventListener("input", () => {
          addBtn.disabled = !input.value.trim();
        });
      }

      function save() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
      }

      function load() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          return raw ? JSON.parse(raw) : [];
        } catch {
          return [];
        }
      }

      function escapeHtml(str) {
        return str.replace(
          /[&<>"']/g,
          (s) =>
            ({
              "&": "&amp;",
              "<": "&lt;",
              ">": "&gt;",
              '"': "&quot;",
              "'": "&#39;",
            }[s])
        );
      }

      function formatDate(ts) {
        const d = new Date(ts);

        return d.toLocaleString("tr-TR", {
          day: "2-digit",
          month: "2-digit",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }
    </script>
  </body>
</html>
