<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chuck Norris Şakaları</title>
    <meta
      name="description"
      content="Chuck Norris şakalarını canlı olarak getir ve gülümse."
    />
    <style>
      :root {
        --bg: #0f1226;
        --card: #171a33;
        --text: #e9ecff;
        --muted: #a7b0d6;
        --accent: #ffcc00;
        --accent-ghost: rgba(255, 204, 0, 0.15);
        --border: #2a2f55;
        --danger: #ff5a5f;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        background: radial-gradient(
          1200px 600px at 20% 0%,
          #1a1f44 0%,
          var(--bg) 60%
        );
        color: var(--text);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }
      .app {
        width: 100%;
        max-width: 760px;
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
        overflow: hidden;
      }
      .header {
        padding: 20px 24px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .logo {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--accent-ghost);
        display: grid;
        place-items: center;
        color: #111;
        font-weight: 900;
      }
      .title {
        font-size: 18px;
        margin: 0;
        letter-spacing: 0.3px;
      }
      .content {
        padding: 24px;
        display: grid;
        gap: 16px;
      }
      .joke {
        font-size: 18px;
        line-height: 1.6;
        background: #12152b;
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 18px;
      }
      .meta {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        color: var(--muted);
        font-size: 13px;
      }
      .chip {
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 6px 10px;
        background: #0e1130;
      }
      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 8px;
      }
      button {
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 700;
        padding: 12px 16px;
      }
      .btn-primary {
        background: var(--accent);
        color: #111;
      }
      .btn-secondary {
        background: #0e1130;
        color: var(--text);
        border: 1px solid var(--border);
      }
      .btn-danger {
        background: var(--danger);
        color: #fff;
      }
      .footer {
        padding: 16px 24px;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        color: var(--muted);
        font-size: 13px;
      }
      a {
        color: var(--accent);
        text-decoration: none;
      }
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
      }
    </style>
  </head>
  <body>
    <main class="app" id="app" aria-live="polite">
      <div class="header">
        <div class="logo" aria-hidden="true">CN</div>
        <h1 class="title">Chuck Norris Şakaları</h1>
        <span class="sr-only">Her yenilemede yeni bir şaka gelir</span>
      </div>

      <section class="content">
        <div id="joke" class="joke">Şaka yükleniyor…</div>
        <div class="meta">
          <span id="category" class="chip">Kategori: —</span>
          <span id="updated" class="chip">Güncelleme: —</span>
          <span id="id" class="chip">ID: —</span>
        </div>
        <div class="actions">
          <button id="next" class="btn-primary">Başka Bir Şaka</button>
          <button id="copy" class="btn-secondary">Kopyala</button>
          <button id="tweet" class="btn-secondary">Tweetle</button>
          <button id="clear" class="btn-danger">Temizle</button>
        </div>
      </section>

      <div class="footer">
        <span
          >Kaynak:
          <a href="https://api.chucknorris.io" target="_blank" rel="noopener"
            >Chuck Norris Jokes API</a
          ></span
        >
        <span>Made with ♥ by Selin</span>
      </div>
    </main>

    <script>
      const API = "https://api.chucknorris.io/jokes/random";
      const jokeEl = document.getElementById("joke");
      const categoryEl = document.getElementById("category");
      const updatedEl = document.getElementById("updated");
      const idEl = document.getElementById("id");
      const nextBtn = document.getElementById("next");
      const copyBtn = document.getElementById("copy");
      const tweetBtn = document.getElementById("tweet");
      const clearBtn = document.getElementById("clear");

      // İlk yüklemede şaka getir
      fetchJoke();

      // Etkileşimler
      nextBtn.addEventListener("click", fetchJoke);
      copyBtn.addEventListener("click", copyJoke);
      tweetBtn.addEventListener("click", tweetJoke);
      clearBtn.addEventListener("click", clearJoke);

      async function fetchJoke() {
        setLoading(true);
        try {
          const res = await fetch(API, {
            headers: { Accept: "application/json" },
          });
          if (!res.ok)
            throw new Error("Şaka alınamadı. Lütfen tekrar deneyin.");
          const data = await res.json();
          renderJoke(data);
        } catch (err) {
          renderError(err.message);
        } finally {
          setLoading(false);
        }
      }

      function renderJoke(data) {
        jokeEl.textContent = data.value;
        categoryEl.textContent =
          "Kategori: " + (data.categories?.[0] || "Genel");
        updatedEl.textContent =
          "Güncelleme: " + new Date(data.updated_at).toLocaleString("tr-TR");
        idEl.textContent = "ID: " + data.id;
        jokeEl.setAttribute("data-id", data.id);
      }

      function renderError(msg) {
        jokeEl.textContent = "Hata: " + msg;
        categoryEl.textContent = "Kategori: —";
        updatedEl.textContent = "Güncelleme: —";
        idEl.textContent = "ID: —";
      }

      function setLoading(isLoading) {
        nextBtn.disabled = isLoading;
        nextBtn.textContent = isLoading ? "Yükleniyor…" : "Başka Bir Şaka";
      }

      async function copyJoke() {
        try {
          await navigator.clipboard.writeText(jokeEl.textContent);
          copyBtn.textContent = "Kopyalandı!";
          setTimeout(() => (copyBtn.textContent = "Kopyala"), 1200);
        } catch {
          alert("Kopyalama başarısız oldu.");
        }
      }

      function tweetJoke() {
        const text = encodeURIComponent(jokeEl.textContent + " #ChuckNorris");
        const url = "https://twitter.com/intent/tweet?text=" + text;
        window.open(url, "_blank", "noopener");
      }

      function clearJoke() {
        jokeEl.textContent = "Şaka temizlendi. Yeni şaka için butona bas.";
        categoryEl.textContent = "Kategori: —";
        updatedEl.textContent = "Güncelleme: —";
        idEl.textContent = "ID: —";
      }
    </script>
  </body>
</html>
